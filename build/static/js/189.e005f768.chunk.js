/*! For license information please see 189.e005f768.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunknutrea_genie=self.webpackChunknutrea_genie||[]).push([[189],{9928:(e,a,t)=>{t.d(a,{E:()=>c});var s=t(9379),n=t(3986);t(5043);const l={badge:"badge_badge__++Ebc",default:"badge_default__j8H14",secondary:"badge_secondary__+3nKx",destructive:"badge_destructive__CY6v+",outline:"badge_outline__cEWy-"};var i=t(579);const r=["className","variant"];function c(e){let{className:a,variant:t="default"}=e,c=(0,n.A)(e,r);const o=l[t]||l.default;return(0,i.jsx)("div",(0,s.A)({className:"".concat(l.badge," ").concat(o," ").concat(a||"")},c))}},6764:(e,a,t)=>{t.d(a,{p:()=>o});var s=t(9379),n=t(3986),l=t(5043);const i="input_input__haKzV";var r=t(579);const c=["className","type"],o=l.forwardRef(((e,a)=>{const{className:t,type:l}=e,o=(0,n.A)(e,c);return(0,r.jsx)("input",(0,s.A)({type:l,className:"".concat(i," ").concat(t||""),ref:a},o))}));o.displayName="Input"},8837:(e,a,t)=>{t.d(a,{J:()=>d});var s=t(9379),n=t(3986),l=t(5043),i=t(2367);const r="label_label__JZ87o";var c=t(579);const o=["className"],d=l.forwardRef(((e,a)=>{const{className:t}=e,l=(0,n.A)(e,o);return(0,c.jsx)(i.b,(0,s.A)({ref:a,className:"".concat(r," ").concat(t||"")},l))}));d.displayName=i.b.displayName},3488:(e,a,t)=>{t.d(a,{A:()=>s});const s=" https://3-104-203-150.nip.io"},8189:(e,a,t)=>{t.r(a),t.d(a,{default:()=>ne});var s=t(9379),n=t(5043),l=t(3216),i=t(9722),r=t(3488),c=t(3403),o=t(6764),d=t(3986);const m="table_tableWrapper__oo-pX",u="table_table__yyd4M",h="table_tableHeader__9qkha",_="table_tableRow__aomRC",p="table_tableHead__4WwW6",v="table_tableCell__qhSjO";var x=t(579);const j=["children","className"],A=["children"],b=["children"],f=["children"],N=["children"],g=["children"],y=e=>{let{children:a,className:t}=e,n=(0,d.A)(e,j);return(0,x.jsx)("div",{className:m,children:(0,x.jsx)("table",(0,s.A)((0,s.A)({className:"".concat(u," ").concat(t)},n),{},{children:a}))})},C=e=>{let{children:a}=e,t=(0,d.A)(e,A);return(0,x.jsx)("thead",(0,s.A)((0,s.A)({className:h},t),{},{children:a}))},k=e=>{let{children:a}=e,t=(0,d.A)(e,b);return(0,x.jsx)("tbody",(0,s.A)((0,s.A)({},t),{},{children:a}))},w=e=>{let{children:a}=e,t=(0,d.A)(e,f);return(0,x.jsx)("tr",(0,s.A)((0,s.A)({className:_},t),{},{children:a}))},S=e=>{let{children:a}=e,t=(0,d.A)(e,N);return(0,x.jsx)("th",(0,s.A)((0,s.A)({className:p},t),{},{children:a}))},I=e=>{let{children:a}=e,t=(0,d.A)(e,g);return(0,x.jsx)("td",(0,s.A)((0,s.A)({className:v},t),{},{children:a}))};var B=t(9928),L=t(8499),M=t(6330),z=t(8837),E=t(8438),H=t(1114);const T=(0,H.A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),W=(0,H.A)("ArrowUpNarrowWide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]]),G=(0,H.A)("ArrowDownWideNarrow",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]]),R=(0,H.A)("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);var U=t(8803);const P="pagination_pagination__y0-UO",D="pagination_paginationList__P5G2T",J="pagination_paginationItem__XBVH3",q=e=>{let{currentPage:a,totalCount:t,pageSize:s,onPageChange:n}=e;const l=Math.ceil(t/s);if(l<=1)return null;const i=[];for(let r=1;r<=l;r++)i.push(r);return(0,x.jsx)("nav",{className:P,children:(0,x.jsx)("ul",{className:D,children:i.map((e=>(0,x.jsx)("li",{className:J,children:(0,x.jsx)(L.$,{onClick:()=>n(e),variant:a===e?"default":"outline",size:"sm",children:e})},e)))})})},F="alert_alert__UJ-Di",O="alert_default__2+1fM",V="alert_destructive__J1cd1",$="alert_title__JPQOL",X="alert_description__Pn04L",Z=["className","variant"],K=["className"],Y=["className"],Q=n.forwardRef(((e,a)=>{let{className:t,variant:n="default"}=e,l=(0,d.A)(e,Z);const i="default"===n?O:V;return(0,x.jsx)("div",(0,s.A)({ref:a,role:"alert",className:"".concat(F," ").concat(i," ").concat(t||"")},l))}));Q.displayName="Alert";n.forwardRef(((e,a)=>{let{className:t}=e,n=(0,d.A)(e,K);return(0,x.jsx)("h5",(0,s.A)({ref:a,className:"".concat($," ").concat(t||"")},n))})).displayName="AlertTitle";const ee=n.forwardRef(((e,a)=>{let{className:t}=e,n=(0,d.A)(e,Y);return(0,x.jsx)("div",(0,s.A)({ref:a,className:"".concat(X," ").concat(t||"")},n))}));ee.displayName="AlertDescription";var ae=t(7757);const te={backButton:"Admin_backButton__3Ubvg",editButton:"Admin_editButton__g9kdO",dashboardCard:"Admin_dashboardCard__d5V9E",dashboardHeader:"Admin_dashboardHeader__REewa",dashboardTitle:"Admin_dashboardTitle__BvOJx",dashboardContent:"Admin_dashboardContent__0MmJh",controls:"Admin_controls__Fm0R+",searchWrapper:"Admin_searchWrapper__Ksic2",deleteButton:"Admin_deleteButton__GIUpq",cancelButton:"Admin_cancelButton__4isGt",searchIcon:"Admin_searchIcon__SECdx",searchInput:"Admin_searchInput__7Z+lP",filtersWrapper:"Admin_filtersWrapper__p+pzM",filterSelect:"Admin_filterSelect__uH+nz",tableWrapper:"Admin_tableWrapper__uvkXG",sortableHeader:"Admin_sortableHeader__WXwSZ",sortIcon:"Admin_sortIcon__SrHRX",tableRow:"Admin_tableRow__mHsm7",badge:"Admin_badge__wc4LJ",active:"Admin_active__vXG3r",inactive:"Admin_inactive__xg+F4",admin:"Admin_admin__jC6at",user:"Admin_user__OWSfj",actionButtons:"Admin_actionButtons__3+CJU",buttonIcon:"Admin_buttonIcon__mTAHn",form:"Admin_form__P7G3x",formGroup:"Admin_formGroup__LVGAo",formActions:"Admin_formActions__sgOxH",dialogContent:"Admin_dialogContent__xVh6d",dialogActions:"Admin_dialogActions__YfT3s",fadeIn:"Admin_fadeIn__7TkST"},se=e=>{let{user:a,onSubmit:t,onCancel:l}=e;const[i,r]=(0,n.useState)(a||{name:"",email:"",phone:"",status:"active",role:"user"}),c=e=>{const{name:a,value:t}=e.target;r((e=>(0,s.A)((0,s.A)({},e),{},{[a]:t})))};return(0,x.jsxs)("form",{onSubmit:e=>{e.preventDefault(),t(i)},className:te.form,children:[(0,x.jsxs)("div",{className:te.formGroup,children:[(0,x.jsx)(z.J,{htmlFor:"name",children:"Name"}),(0,x.jsx)(o.p,{id:"name",name:"name",value:i.name,onChange:c,required:!0})]}),(0,x.jsxs)("div",{className:te.formGroup,children:[(0,x.jsx)(z.J,{htmlFor:"email",children:"Email"}),(0,x.jsx)(o.p,{id:"email",name:"email",type:"email",value:i.email,onChange:c,required:!0})]}),(0,x.jsxs)("div",{className:te.formGroup,children:[(0,x.jsx)(z.J,{htmlFor:"phone",children:"Phone"}),(0,x.jsx)(o.p,{id:"phone",name:"phone",value:i.phone,onChange:c,required:!0})]}),(0,x.jsxs)("div",{className:te.formActions,children:[(0,x.jsx)(L.$,{className:te.cancelButton,type:"button",variant:"outline",onClick:l,children:"Cancel"}),(0,x.jsx)(L.$,{type:"submit",children:"Save Changes"})]})]})},ne=()=>{const[e,a]=(0,n.useState)([]),[t,s]=(0,n.useState)(""),[d,m]=(0,n.useState)("name"),[u,h]=(0,n.useState)("asc"),[_,p]=(0,n.useState)(1),[v]=(0,n.useState)(10),[j,A]=(0,n.useState)("all"),[b,f]=(0,n.useState)("all"),[N,g]=(0,n.useState)(null),[z,H]=(0,n.useState)(!1),[P,D]=(0,n.useState)(null),{toast:J}=(0,ae.d)(),F=(0,l.Zp)(),O=localStorage.getItem("accessToken");(0,n.useEffect)((()=>{O||F("/login")}),[O,F]);const V=(0,n.useCallback)((async()=>{try{const e=(await i.A.get("".concat(r.A,"/api/v1/admin/users/"),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(O)}})).data.results.map((e=>({id:e.id,name:"".concat(e.first_name," ").concat(e.last_name),email:e.email,phone:e.phone_number,status:e.is_active?"active":"inactive",lastLogin:e.last_login,role:e.roles.join(", ")})));a(e)}catch(n){var e,t,s;if("token_not_valid"===(null===(e=n.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.code)||401===(null===(s=n.response)||void 0===s?void 0:s.status))return localStorage.removeItem("accessToken"),void F("/login");J({title:"Error",description:"Failed to fetch users.",variant:"destructive"})}}),[O,F,J]);(0,n.useEffect)((()=>{V()}),[V]);const $=(0,n.useMemo)((()=>{let a=e;return t&&(a=a.filter((e=>e.name.toLowerCase().includes(t.toLowerCase())||e.email.toLowerCase().includes(t.toLowerCase())||e.phone&&e.phone.includes(t)))),"all"!==j&&(a=a.filter((e=>e.status===j))),"all"!==b&&(a=a.filter((e=>e.role.toLowerCase().includes(b.toLowerCase())))),a.sort(((e,a)=>e[d]<a[d]?"asc"===u?-1:1:e[d]>a[d]?"asc"===u?1:-1:0))}),[e,t,j,b,d,u]),X=(0,n.useMemo)((()=>{const e=_*v,a=e-v;return $.slice(a,e)}),[$,_,v]),Z=e=>{e===d?h((e=>"asc"===e?"desc":"asc")):(m(e),h("asc"))};return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(L.$,{variant:"ghost",size:"sm",className:te.backButton,onClick:()=>F(-1),children:[(0,x.jsx)(E.A,{className:te.backIcon}),"Back"]}),(0,x.jsxs)(c.Zp,{className:te.dashboardCard,children:[(0,x.jsx)("div",{className:te.dashboardHeader,children:(0,x.jsx)("h2",{className:te.dashboardTitle,children:"User Dashboard"})}),(0,x.jsxs)("div",{className:te.dashboardContent,children:[(0,x.jsx)("div",{className:te.controls,children:(0,x.jsxs)("div",{className:te.searchWrapper,children:[(0,x.jsx)(T,{className:te.searchIcon}),(0,x.jsx)(o.p,{type:"text",placeholder:"Search users...",value:t,onChange:e=>s(e.target.value),className:te.searchInput})]})}),(0,x.jsx)("div",{className:te.tableWrapper,children:(0,x.jsxs)(y,{children:[(0,x.jsx)(C,{children:(0,x.jsxs)(w,{children:[(0,x.jsxs)(S,{onClick:()=>Z("name"),className:te.sortableHeader,children:["Name"," ","name"===d&&(0,x.jsx)("span",{className:te.sortIcon,children:"asc"===u?(0,x.jsx)(W,{size:14}):(0,x.jsx)(G,{size:14})})]}),(0,x.jsxs)(S,{onClick:()=>Z("email"),className:te.sortableHeader,children:["Email"," ","email"===d&&(0,x.jsx)("span",{className:te.sortIcon,children:"asc"===u?(0,x.jsx)(W,{size:14}):(0,x.jsx)(G,{size:14})})]}),(0,x.jsx)(S,{children:"Phone"}),(0,x.jsx)(S,{children:"Status"}),(0,x.jsxs)(S,{onClick:()=>Z("lastLogin"),className:te.sortableHeader,children:["Last Login"," ","lastLogin"===d&&(0,x.jsx)("span",{className:te.sortIcon,children:"asc"===u?(0,x.jsx)(W,{size:14}):(0,x.jsx)(G,{size:14})})]}),(0,x.jsx)(S,{children:"Role"}),(0,x.jsx)(S,{children:"Actions"})]})}),(0,x.jsx)(k,{children:X.map((e=>(0,x.jsxs)(w,{className:te.tableRow,children:[(0,x.jsx)(I,{children:e.name}),(0,x.jsx)(I,{children:e.email}),(0,x.jsx)(I,{children:e.phone}),(0,x.jsx)(I,{children:(0,x.jsx)(B.E,{className:"".concat(te.badge," ").concat(te[e.status]),children:e.status})}),(0,x.jsx)(I,{children:e.lastLogin}),(0,x.jsx)(I,{children:(0,x.jsx)(B.E,{className:"".concat(te.badge," ").concat(te[e.role]),children:e.role})}),(0,x.jsx)(I,{children:(0,x.jsxs)("div",{className:te.actionButtons,children:[(0,x.jsxs)(L.$,{variant:"outline",className:te.editButton,onClick:()=>(e=>{g(e)})(e),children:[(0,x.jsx)(R,{size:14,className:te.buttonIcon})," Edit"]}),(0,x.jsxs)(L.$,{variant:"destructive",className:te.deleteButton,onClick:()=>(e=>{D(e),H(!0)})(e),children:[(0,x.jsx)(U.A,{size:14,className:te.buttonIcon})," ","Delete"]})]})})]},e.id)))})]})}),(0,x.jsx)(q,{className:te.pagination,currentPage:_,totalCount:$.length,pageSize:v,onPageChange:p})]}),(0,x.jsx)(M.lG,{open:!!N,onOpenChange:()=>g(null),children:(0,x.jsxs)(M.Cf,{className:te.dialogContent,children:[(0,x.jsx)(M.c7,{children:(0,x.jsx)(M.L3,{children:"Edit User"})}),(0,x.jsx)(se,{user:N,onSubmit:async e=>{if(e.id)try{const[t,...s]=e.name.split(" "),n={email:e.email,first_name:t,last_name:s.join(" "),phone_number:e.phone};await i.A.patch("".concat(r.A,"/api/v1/admin/users/").concat(e.id,"/"),n,{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(O)}}),a((a=>a.map((a=>a.id===e.id?e:a)))),g(null),J({title:"User Updated",description:"User information has been successfully updated."})}catch(l){var t,s,n;if("token_not_valid"===(null===(t=l.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.code)||401===(null===(n=l.response)||void 0===n?void 0:n.status))return localStorage.removeItem("accessToken"),void F("/login");J({title:"Error",description:"Failed to update user.",variant:"destructive"})}else J({title:"Error",description:"User id is missing.",variant:"destructive"})},onCancel:()=>g(null)})]})}),(0,x.jsx)(M.lG,{open:z,onOpenChange:H,children:(0,x.jsxs)(M.Cf,{className:te.dialogContent,children:[(0,x.jsx)(M.c7,{children:(0,x.jsx)(M.L3,{children:"Confirm Deletion"})}),(0,x.jsx)(Q,{variant:"destructive",children:(0,x.jsxs)(ee,{children:["Are you sure you want to delete ",null===P||void 0===P?void 0:P.name,"? This action cannot be undone."]})}),(0,x.jsxs)("div",{className:te.dialogActions,children:[(0,x.jsx)(L.$,{className:te.cancelButton,variant:"outline",onClick:()=>H(!1),children:"Cancel"}),(0,x.jsx)(L.$,{variant:"destructive",className:te.deleteButton,onClick:async()=>{if(null!==P&&void 0!==P&&P.id)try{await i.A.delete("".concat(r.A,"/api/v1/admin/users/").concat(P.id,"/"),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(O)}}),a((e=>e.filter((e=>e.id!==P.id)))),H(!1),J({title:"User Deleted",description:"".concat(P.name," has been removed from the system.")})}catch(n){var e,t,s;if("token_not_valid"===(null===(e=n.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.code)||401===(null===(s=n.response)||void 0===s?void 0:s.status))return localStorage.removeItem("accessToken"),void F("/login");J({title:"Error",description:"Failed to delete user.",variant:"destructive"})}else J({title:"Error",description:"User id is missing.",variant:"destructive"})},children:"Delete"})]})]})})]})]})}},2367:(e,a,t)=>{t.d(a,{b:()=>c});var s=t(9379),n=t(5043),l=t(7920),i=t(579),r=n.forwardRef(((e,a)=>(0,i.jsx)(l.sG.label,(0,s.A)((0,s.A)({},e),{},{ref:a,onMouseDown:a=>{var t;a.target.closest("button, input, select, textarea")||(null===(t=e.onMouseDown)||void 0===t||t.call(e,a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}))));r.displayName="Label";var c=r},8438:(e,a,t)=>{t.d(a,{A:()=>s});const s=(0,t(1114).A)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},8803:(e,a,t)=>{t.d(a,{A:()=>s});const s=(0,t(1114).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])}}]);
//# sourceMappingURL=189.e005f768.chunk.js.map